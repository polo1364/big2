<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Â§ßËÄÅ‰∫å ‚Äî ÂÑ™ÂåñÁâà</title>
<style>
:root{
  --card-w:76px;--card-h:108px;--gap:10px;
  --pile-w:54px;--pile-h:76px;
  --panel-w:min(94vw,1080px);
  --primary:#3b82f6;
  --success:#10b981;
  --danger:#ef4444;
  --warning:#f59e0b;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
  margin:0;
  background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color:#fff;
  font-family:"Microsoft JhengHei",system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  user-select:none;
  overflow:hidden;
  position:relative;
}
body::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(circle at 20% 50%, rgba(120,119,198,0.3), transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(138,80,164,0.3), transparent 50%);
  pointer-events:none;
}
h1{
  margin:0;
  font-weight:900;
  letter-spacing:2px;
  font-size:28px;
  text-shadow:0 2px 10px rgba(0,0,0,0.3);
  background:linear-gradient(135deg, #fff 0%, #e0e7ff 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
#stage{
  position:relative;
  width:100%;
  height:100dvh;
  display:grid;
  grid-template-rows:auto 1fr auto;
  z-index:1;
}
.topbar{
  display:flex;
  justify-content:center;
  align-items:center;
  padding:16px 20px;
  gap:12px;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(20px);
  border-bottom:1px solid rgba(255,255,255,0.15);
}
/* Âè≥‰∏äËßíÈñãÈóú */
#sfxToggle,#bgmToggle{
  position:absolute;
  right:16px;
  z-index:6;
  border:none;
  border-radius:16px;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(10px);
  color:#fff;
  padding:12px 16px;
  min-height:48px;
  cursor:pointer;
  font-weight:800;
  border:2px solid rgba(255,255,255,0.25);
  transition:all 0.3s ease;
  font-size:14px;
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
}
#sfxToggle{top:16px}
#bgmToggle{top:76px}
#sfxToggle:hover,#bgmToggle:hover{
  background:rgba(255,255,255,0.25);
  transform:translateY(-2px);
  box-shadow:0 6px 16px rgba(0,0,0,0.2);
}
.table{
  position:relative;
  flex:1;
  display:grid;
  grid-template-columns:1fr auto 1fr;
  grid-template-rows:1fr auto 1fr;
  height:100%;
  gap:12px;
  padding:12px;
}
.player{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:10px;
}
.name{
  font-weight:900;
  letter-spacing:1px;
  font-size:18px;
  text-shadow:0 2px 8px rgba(0,0,0,0.3);
}
.score{
  font-size:14px;
  font-weight:700;
  background:rgba(255,255,255,0.2);
  backdrop-filter:blur(10px);
  border:2px solid rgba(255,255,255,0.3);
  padding:6px 14px;
  border-radius:999px;
  box-shadow:0 2px 8px rgba(0,0,0,0.15);
}
.count{
  font-size:16px;
  font-weight:800;
  color:#fbbf24;
  text-shadow:0 2px 6px rgba(0,0,0,0.3);
}
.player:not(#p-bottom) .hand{display:none}
.hand{
  display:flex;
  gap:var(--gap);
  max-width:96vw;
  overflow-x:auto;
  padding:8px 6px;
  touch-action:pan-x;
  pointer-events:auto;
}
#hand-bottom.two-rows{
  flex-wrap:wrap;
  row-gap:12px;
  justify-content:center;
  overflow-x:hidden;
}
#hand-bottom.two-rows .card{
  width:calc(var(--card-w)*0.9);
  height:calc(var(--card-w)*0.9*1.42);
  min-width:calc(var(--card-w)*0.9);
}
.card{
  position:relative;
  width:var(--card-w);
  height:var(--card-h);
  min-width:var(--card-w);
  background:linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
  border-radius:12px;
  border:3px solid #e2e8f0;
  color:#1e293b;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:26px;
  transition:all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  touch-action:manipulation;
  cursor:pointer;
  box-shadow:0 4px 12px rgba(0,0,0,0.15), 0 2px 4px rgba(0,0,0,0.1);
}
.card::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:10px;
  background:linear-gradient(145deg, rgba(255,255,255,0.8), rgba(255,255,255,0));
  opacity:0.6;
  pointer-events:none;
}
.card:hover{
  transform:translateY(-8px);
  box-shadow:0 8px 20px rgba(0,0,0,0.2), 0 4px 8px rgba(0,0,0,0.15);
}
.card.‚ô•,.card.‚ô¶{color:#dc2626;text-shadow:0 1px 2px rgba(220,38,38,0.2)}
.card.‚ô†,.card.‚ô£{color:#1e293b;text-shadow:0 1px 2px rgba(30,41,59,0.2)}
.selected{
  transform:translateY(-24px) scale(1.05);
  border-color:#fbbf24;
  box-shadow:0 12px 32px rgba(251,191,36,0.4), 0 0 0 4px rgba(251,191,36,0.3);
  background:linear-gradient(145deg, #fffbeb 0%, #fef3c7 100%);
}
#centerPanel{
  grid-column:2;
  grid-row:2;
  width:var(--panel-w);
  background:rgba(255,255,255,0.12);
  backdrop-filter:blur(30px);
  border:2px solid rgba(255,255,255,0.25);
  border-radius:24px;
  padding:20px 24px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
  position:relative;
  overflow:visible;
  box-shadow:0 8px 32px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.2);
}
#centerTools{
  display:flex;
  gap:10px;
  align-self:flex-start;
}
#fx{
  position:absolute;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  z-index:5;
  border-radius:24px;
}
#info{
  font-size:17px;
  font-weight:700;
  text-shadow:0 2px 6px rgba(0,0,0,0.2);
}
#last{
  font-size:14px;
  opacity:0.9;
  min-height:20px;
  font-weight:600;
}
#pile{
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
  position:relative;
  z-index:2;
  padding:12px;
  background:rgba(0,0,0,0.15);
  border-radius:16px;
  min-height:120px;
}
.pile-card{
  width:var(--pile-w);
  height:var(--pile-h);
  background:linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
  border-radius:10px;
  border:3px solid #e2e8f0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:20px;
  box-shadow:0 3px 10px rgba(0,0,0,0.15);
  transition:transform 0.2s ease;
}
.pile-card:hover{transform:scale(1.05)}
.pile-card.‚ô•,.pile-card.‚ô¶{color:#dc2626}
.pile-card.‚ô†,.pile-card.‚ô£{color:#1e293b}
#logCenter{
  width:100%;
  max-width:900px;
  height:130px;
  overflow-y:auto;
  border:2px solid rgba(255,255,255,0.2);
  border-radius:16px;
  padding:12px;
  background:rgba(0,0,0,0.25);
  backdrop-filter:blur(10px);
  font-size:13px;
  display:flex;
  flex-direction:column;
  box-shadow:inset 0 2px 8px rgba(0,0,0,0.2);
}
.log-line{
  display:flex;
  align-items:center;
  gap:10px;
  margin:4px 0;
  padding:4px;
  border-radius:8px;
  transition:background 0.2s ease;
}
.log-line:hover{background:rgba(255,255,255,0.05)}
.log-who{
  font-weight:800;
  min-width:70px;
  text-align:right;
}
.log-kind{opacity:0.85;font-weight:600}
.log-cards{display:flex;gap:5px;flex-wrap:wrap}
.log-card{
  width:32px;
  height:44px;
  background:linear-gradient(145deg, #fff 0%, #f8fafc 100%);
  border:2px solid #cbd5e1;
  border-radius:6px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
  color:#1e293b;
  font-size:11px;
  box-shadow:0 2px 4px rgba(0,0,0,0.1);
}
.log-card.‚ô•,.log-card.‚ô¶{color:#dc2626}
.actionRow{
  grid-column:2;
  display:flex;
  gap:14px;
  justify-content:center;
  margin-top:4px;
  flex-wrap:wrap;
}
button{
  font:inherit;
  font-weight:800;
  letter-spacing:0.5px;
  padding:14px 24px;
  border-radius:16px;
  border:none;
  background:linear-gradient(135deg, var(--primary) 0%, #2563eb 100%);
  color:#fff;
  cursor:pointer;
  min-width:120px;
  min-height:56px;
  font-size:17px;
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 4px 14px rgba(59,130,246,0.4), 0 2px 4px rgba(0,0,0,0.1);
  position:relative;
  overflow:hidden;
}
button::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(135deg, rgba(255,255,255,0.2), transparent);
  opacity:0;
  transition:opacity 0.3s ease;
}
button:hover::before{opacity:1}
button:hover{
  transform:translateY(-3px);
  box-shadow:0 8px 24px rgba(59,130,246,0.5), 0 4px 8px rgba(0,0,0,0.15);
}
button:active{
  transform:translateY(-1px);
  box-shadow:0 4px 12px rgba(59,130,246,0.4);
}
button[disabled]{
  opacity:0.5;
  cursor:not-allowed;
  transform:none !important;
}
.btn-ghost{
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(10px);
  color:#fff;
  border:2px solid rgba(255,255,255,0.25);
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
}
.btn-ghost:hover{
  background:rgba(255,255,255,0.25);
  box-shadow:0 6px 18px rgba(0,0,0,0.2);
}
.btn-small{
  min-width:auto;
  min-height:auto;
  padding:10px 14px;
  border-radius:12px;
  font-size:14px;
}
#p-top{grid-column:2;grid-row:1;justify-content:flex-end}
#p-left{grid-column:1;grid-row:2}
#p-right{grid-column:3;grid-row:2}
#p-bottom{grid-column:2;grid-row:3;justify-content:flex-start}

/* ÊèêÁ§∫Èù¢Êùø */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.75);
  backdrop-filter:blur(8px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:40;
  padding:16px;
  animation:fadeIn 0.3s ease;
}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.panel{
  width:min(94vw,920px);
  max-height:85vh;
  overflow:auto;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(40px);
  border:2px solid rgba(255,255,255,0.3);
  border-radius:24px;
  padding:24px;
  box-shadow:0 20px 60px rgba(0,0,0,0.4);
  animation:slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}
@keyframes slideUp{from{transform:translateY(40px);opacity:0}to{transform:translateY(0);opacity:1}}
#hintPanel h2{margin:0 0 16px;font-size:24px;font-weight:900}
#hintToolbar{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:16px;
}
.chip{
  padding:10px 16px;
  border-radius:999px;
  background:rgba(255,255,255,0.15);
  border:2px solid rgba(255,255,255,0.25);
  font-size:15px;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s ease;
}
.chip:hover{
  background:rgba(255,255,255,0.25);
  transform:translateY(-2px);
}
.chip.active{
  background:linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
  border-color:#fbbf24;
  box-shadow:0 4px 12px rgba(251,191,36,0.4);
}
.section{margin:16px 0 12px}
.section h4{
  margin:8px 0 10px;
  font-size:16px;
  font-weight:800;
}
.combo-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
  gap:10px;
}
.combo-row{
  display:flex;
  align-items:center;
  gap:8px;
  padding:12px;
  border-radius:14px;
  background:rgba(255,255,255,0.1);
  border:2px solid rgba(255,255,255,0.2);
  cursor:pointer;
  transition:all 0.3s ease;
}
.combo-row:hover{
  background:rgba(255,255,255,0.2);
  transform:translateY(-2px);
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
}
.mini{
  width:38px;
  height:54px;
  background:linear-gradient(145deg, #fff 0%, #f8fafc 100%);
  border:2px solid #cbd5e1;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
  color:#1e293b;
  font-size:13px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
}
.mini.‚ô•,.mini.‚ô¶{color:#dc2626}
.tag{
  margin-left:auto;
  font-size:13px;
  font-weight:700;
  opacity:0.8;
}

/* ÁµêÁÆó */
.panel h2{margin:0 0 16px;font-size:24px;font-weight:900}
.pList{list-style:none;margin:0;padding:0}
.pItem{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px;
  border-radius:14px;
  background:rgba(255,255,255,0.1);
  border:2px solid rgba(255,255,255,0.2);
  margin-bottom:10px;
  transition:all 0.3s ease;
}
.pItem:hover{
  background:rgba(255,255,255,0.15);
  transform:translateX(4px);
}
.pName{font-weight:900;font-size:16px}
.pExplain{opacity:0.85;font-size:13px;margin-top:4px}
.pRight{display:flex;gap:16px;align-items:center}
.pDelta{font-weight:900;font-size:18px}
.pDelta.plus{color:#10b981;text-shadow:0 2px 4px rgba(16,185,129,0.3)}
.pDelta.minus{color:#ef4444;text-shadow:0 2px 4px rgba(239,68,68,0.3)}
.pScore{font-weight:900;font-size:18px}
.rank{list-style:none;margin:12px 0 0;padding:0}
.rank li{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px 16px;
  border-radius:14px;
  background:rgba(255,255,255,0.1);
  border:2px solid rgba(255,255,255,0.2);
  margin-bottom:10px;
  font-weight:800;
  font-size:16px;
}

/* FX */
@keyframes fx-pop{
  0%{transform:translate(-50%,-50%) scale(0.5);opacity:0}
  60%{transform:translate(-50%,-50%) scale(1.15);opacity:1}
  100%{transform:translate(-50%,-50%) scale(1);opacity:1}
}
.fx-symbol{
  position:absolute;
  left:50%;
  top:25%;
  transform:translate(-50%,-50%);
  font-weight:900;
  font-size:80px;
  line-height:1;
  border-radius:20px;
  padding:16px 24px;
  background:linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(251,191,36,0.95) 100%);
  color:#1e293b;
  border:4px solid rgba(251,191,36,0.8);
  box-shadow:0 12px 40px rgba(0,0,0,0.4), 0 0 60px rgba(251,191,36,0.6);
  animation:fx-pop 0.6s cubic-bezier(0.4, 0, 0.2, 1) both;
  z-index:6;
  text-shadow:0 2px 4px rgba(0,0,0,0.2);
}
.highlight-pile .pile-card{
  box-shadow:0 0 0 4px #fbbf24, 0 8px 32px rgba(251,191,36,0.6);
  transform:translateY(-4px) scale(1.05);
}

/* ÊªæÂãïÊ¢ùÁæéÂåñ */
::-webkit-scrollbar{width:8px;height:8px}
::-webkit-scrollbar-track{background:rgba(0,0,0,0.2);border-radius:10px}
::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.3);border-radius:10px}
::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,0.5)}
</style>
</head>
<body>
<div id="stage">
  <div class="topbar"><h1>Â§ßËÄÅ‰∫å</h1></div>
  <div class="table">
    <button id="sfxToggle">Èü≥ÊïàÔºöÈñã</button>
    <button id="bgmToggle">Èü≥Ê®ÇÔºöÈóú</button>
    <div id="p-top" class="player"><div class="name" id="name-top"></div><div class="score" id="score-top">10000 ÂàÜ</div><div class="hand" id="hand-top"></div><div class="count" id="cnt-top"></div></div>
    <div id="p-left" class="player"><div class="name" id="name-left"></div><div class="score" id="score-left">10000 ÂàÜ</div><div class="hand" id="hand-left"></div><div class="count" id="cnt-left"></div></div>
    <div id="centerPanel">
      <div id="fx"></div>
      <div id="centerTools">
        <button id="resetScoreBtn" class="btn-ghost btn-small">ÈáçÁΩÆÂàÜÊï∏(10000)</button>
      </div>
      <div id="info">ËºâÂÖ•‰∏≠‚Ä¶</div>
      <div id="last"></div>
      <div id="pile"></div>
      <div id="logCenter"></div>
      <div class="actionRow">
        <button id="autoBtn" class="btn-ghost">‰ª£ÊâìÔºöÈóú</button>
        <button id="playBtn" disabled>Âá∫Áâå</button>
        <button id="passBtn" disabled>PASS</button>
        <button class="btn-ghost" id="hintBtn">ÊèêÁ§∫</button>
        <button class="btn-ghost" id="dealBtn">ÈáçÁôº</button>
      </div>
    </div>
    <div id="p-right" class="player"><div class="name" id="name-right"></div><div class="score" id="score-right">10000 ÂàÜ</div><div class="hand" id="hand-right"></div><div class="count" id="cnt-right"></div></div>
    <div id="p-bottom" class="player">
      <div class="name" id="name-bottom">‰Ω†</div>
      <div class="score" id="score-bottom">10000 ÂàÜ</div>
      <div class="hand" id="hand-bottom"></div>
      <div class="count" id="cnt-bottom"></div>
    </div>
  </div>
</div>

<!-- ÊèêÁ§∫Èù¢Êùø -->
<div id="hintOverlay" class="overlay">
  <div id="hintPanel" class="panel">
    <h2>ÂèØÂá∫ÁµÑÂêà</h2>
    <div id="hintToolbar"></div>
    <div id="hintSections"></div>
  </div>
</div>

<!-- ÂñÆÂ±ÄÁµêÁÆó -->
<div id="roundOverlay" class="overlay">
  <div class="panel">
    <h2 id="roundTitle">Êú¨Â±ÄÁµêÁÆó</h2>
    <ul id="roundList" class="pList"></ul>
    <div style="display:flex;gap:12px;justify-content:center;margin-top:8px">
      <button id="roundContinueBtn">ÁπºÁ∫å‰∏ã‰∏ÄÂ±Ä</button>
    </div>
  </div>
</div>

<!-- Á≥ªÂàóÊà∞ÁµêÁÆó -->
<div id="seriesOverlay" class="overlay">
  <div class="panel">
    <h2>Á≥ªÂàóÊà∞ÁµêÁÆóÔºàÊúâ‰∫∫ÂàÜÊï∏Ê≠∏Èõ∂Ôºâ</h2>
    <ul id="rankList" class="rank"></ul>
    <div style="display:flex;gap:12px;justify-content:center">
      <button id="restartSeriesBtn">ÈáçÊñ∞ÈñãÊñ∞Á≥ªÂàóÔºàÂàÜÊï∏ÈáçÁΩÆ 10000Ôºâ</button>
      <button class="btn-ghost" id="closeSeriesBtn">ÈóúÈñâ</button>
    </div>
  </div>
</div>

<script>
"use strict";
/* ====== Èü≥ÊïàÁ≥ªÁµ±ÔºàWebAudioÔºâ ====== */
const SFX = (()=>{
  let enabled = true;
  let ctx, master;
  function ensure(){
    if(ctx) return;
    ctx = new (window.AudioContext||window.webkitAudioContext)();
    master = ctx.createGain(); master.gain.value = 0.45; master.connect(ctx.destination);
  }
  function tone(freq=440, dur=0.18, type='sine', vol=0.32){ if(!enabled) return; ensure();
    const o=ctx.createOscillator(), g=ctx.createGain();
    o.type=type; o.frequency.value=freq;
    g.gain.setValueAtTime(0.0001, ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(vol, ctx.currentTime+0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+dur);
    o.connect(g); g.connect(master); o.start(); o.stop(ctx.currentTime+dur);
  }
  function chord(freqs, dur=0.3, vol=0.2){ if(!enabled) return; ensure();
    freqs.forEach(f=>tone(f, dur, 'sine', vol));
  }
  return {
    toggle(){ enabled=!enabled; return enabled; },
    isEnabled(){ return enabled; },
    click(){ tone(800, 0.08, 'sine', 0.18); },
    play(){ chord([523,659,784], 0.25, 0.22); },
    pass(){ tone(220, 0.15, 'triangle', 0.25); },
    win(){ chord([523,659,784,1047], 0.4, 0.28); },
    playFor(kind, hasSpade2){
      if(kind==='ÂêåËä±È†Ü' || kind==='ÈêµÊîØ') chord([659,831,988,1175], 0.35, 0.3);
      else if(kind==='Ëë´ËòÜ') chord([523,659,784], 0.28, 0.24);
      else if(kind==='È†ÜÂ≠ê') chord([440,554,659], 0.25, 0.22);
      else if(kind==='‰∏âÊ¢ù') chord([392,494,587], 0.22, 0.2);
      else if(kind==='Â∞çÂ≠ê') chord([349,440], 0.2, 0.18);
      else chord([294,370], 0.18, 0.16);
      if(hasSpade2) setTimeout(()=>chord([1047,1319,1568], 0.3, 0.25), 120);
    }
  };
})();

/* ====== BGM Á≥ªÁµ± ====== */
const BGM = (()=>{
  const tracks = [
    'https://assets.manus.im/big2-bgm/track1.mp3',
    'https://assets.manus.im/big2-bgm/track2.mp3',
    'https://assets.manus.im/big2-bgm/track3.mp3',
    'https://assets.manus.im/big2-bgm/track4.mp3',
    'https://assets.manus.im/big2-bgm/track5.mp3'
  ];
  let audio, enabled=false, idx=0;
  function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } }
  function init(){
    if(audio) return;
    audio = new Audio();
    audio.volume = 0.3;
    audio.addEventListener('ended', ()=>{ idx=(idx+1)%tracks.length; audio.src=tracks[idx]; audio.play().catch(()=>{}); });
  }
  return {
    toggle(){
      init();
      enabled = !enabled;
      if(enabled){ audio.src=tracks[idx]; audio.play().catch(()=>{}); }
      else{ audio.pause(); }
      try{ localStorage.setItem('big2_bgm', enabled?'1':'0'); }catch(e){}
      return enabled;
    },
    isEnabled(){ return enabled; }
  };
})();

document.getElementById('sfxToggle').onclick=()=>{ document.getElementById('sfxToggle').textContent = `Èü≥ÊïàÔºö${SFX.toggle()?'Èñã':'Èóú'}`; };
document.getElementById('bgmToggle').onclick=()=>{ document.getElementById('bgmToggle').textContent = `Èü≥Ê®ÇÔºö${BGM.toggle()?'Èñã':'Èóú'}`; };

/* ====== ÈÅäÊà≤ÈÇèËºØ ====== */
const $=s=>document.querySelector(s);
const RANKS=['3','4','5','6','7','8','9','10','J','Q','K','A','2'];
const SUITS=['‚ô£','‚ô¶','‚ô•','‚ô†'];
const NAMES=['Â∞èÊòé','ÈòøËèØ','Â∞èËä≥','ÈòøÂº∑','Â§ßÈõÑ','ÈùúÈ¶ô','Â∞èÂ§´','ËÉñËôé','Â∞èÁéâ','ÈòøÂÇë'];
let deck=[], players=[[],[],[],[]], scores=[10000,10000,10000,10000], names=['‰Ω†','','',''];
let turn=0, currentPlay=null, lastWinner=-1, firstTrick=true, pendingDeal=false, autoMy=false;
const logBox=$('#logCenter');

function randName(){ return NAMES[Math.floor(Math.random()*NAMES.length)]; }
function buildDeck(){ deck=[]; RANKS.forEach(r=>SUITS.forEach(s=>deck.push({rank:r,suit:s}))); }
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } }
function rIdx(r){ return RANKS.indexOf(r); }
function sIdx(s){ return SUITS.indexOf(s); }
function compareCard(a,b){ const dr=rIdx(a.rank)-rIdx(b.rank); return dr!==0?dr:sIdx(a.suit)-sIdx(b.suit); }
function findStart(){ for(let i=0;i<4;i++) if(players[i].some(c=>c.rank==='3'&&c.suit==='‚ô£')) return i; return 0; }

function saveScores(){ try{ localStorage.setItem('big2_scores', JSON.stringify(scores)); }catch(e){} }
function loadScores(){ try{ const s=localStorage.getItem('big2_scores'); if(s){ scores=JSON.parse(s); updateScoreUI(); } }catch(e){} }
function updateScoreUI(){
  $('#score-bottom').textContent=scores[0]+' ÂàÜ'; $('#score-right').textContent=scores[1]+' ÂàÜ';
  $('#score-top').textContent=scores[2]+' ÂàÜ'; $('#score-left').textContent=scores[3]+' ÂàÜ';
}
function info(msg){ $('#info').textContent=msg; }
function setLast(msg){ $('#last').textContent=msg; }
function clearFX(){ $('#fx').innerHTML=''; $('#pile').classList.remove('highlight-pile'); }
function triggerFX(kind, cards){
  clearFX();
  if(['ÂêåËä±È†Ü','ÈêµÊîØ','Ëë´ËòÜ'].includes(kind)){
    const sym=document.createElement('div'); sym.className='fx-symbol'; sym.textContent=kind; $('#fx').appendChild(sym);
    setTimeout(clearFX, 1800);
  }
  if(['ÂêåËä±È†Ü','ÈêµÊîØ','Ëë´ËòÜ','È†ÜÂ≠ê'].includes(kind)) $('#pile').classList.add('highlight-pile');
}

function logAppendText(txt){ const d=document.createElement('div'); d.className='log-line'; d.textContent=txt; logBox.appendChild(d); logBox.scrollTop=logBox.scrollHeight; }
function logAppendPlay(who, cards, kind){
  const line=document.createElement('div'); line.className='log-line';
  const w=document.createElement('div'); w.className='log-who'; w.textContent=who; line.appendChild(w);
  const k=document.createElement('div'); k.className='log-kind'; k.textContent=kind; line.appendChild(k);
  const cs=document.createElement('div'); cs.className='log-cards';
  cards.forEach(c=>{ const d=document.createElement('div'); d.className='log-card '+c.suit; d.textContent=c.suit+c.rank; cs.appendChild(d); });
  line.appendChild(cs); logBox.appendChild(line); logBox.scrollTop=logBox.scrollHeight;
}

function render(){
  const hb=$('#hand-bottom'); hb.innerHTML='';
  players[0].forEach((c,i)=>{
    const d=document.createElement('div'); d.className='card '+c.suit; d.textContent=c.suit+c.rank; d.dataset.idx=i;
    d.onclick=()=>{ if(turn!==0 || autoMy) return; d.classList.toggle('selected'); SFX.click(); };
    hb.appendChild(d);
  });
  if(players[0].length>10) hb.classList.add('two-rows'); else hb.classList.remove('two-rows');
  $('#cnt-bottom').textContent=players[0].length; $('#cnt-right').textContent=players[1].length;
  $('#cnt-top').textContent=players[2].length; $('#cnt-left').textContent=players[3].length;
}
function updateTurnUI(){
  const canAct = (turn===0 && !autoMy);
  $('#playBtn').disabled = !canAct; $('#passBtn').disabled = !canAct;
  info(turn===0 ? (autoMy?`${names[0]}Ôºà‰ª£Êâì‰∏≠Ôºâ`:`Ëº™Âà∞‰Ω†`) : `Ëº™Âà∞ ${names[turn]}`);
}

/* ÁâåÂûãÂàÜÊûê */
function analyze(cards){
  if(!cards||cards.length===0) return {ok:false};
  const n=cards.length;
  if(n===1) return {ok:true,kind:'ÂñÆÂºµ',key:[rIdx(cards[0].rank),sIdx(cards[0].suit)]};
  if(n===2){
    if(cards[0].rank===cards[1].rank) return {ok:true,kind:'Â∞çÂ≠ê',key:[rIdx(cards[0].rank),Math.max(sIdx(cards[0].suit),sIdx(cards[1].suit))]};
    return {ok:false};
  }
  if(n===3){
    if(cards[0].rank===cards[1].rank&&cards[1].rank===cards[2].rank) return {ok:true,kind:'‰∏âÊ¢ù',key:[rIdx(cards[0].rank),Math.max(sIdx(cards[0].suit),sIdx(cards[1].suit),sIdx(cards[2].suit))]};
    return {ok:false};
  }
  if(n===5){
    const sorted=[...cards].sort(compareCard);
    const rc={}; sorted.forEach(c=>rc[c.rank]=(rc[c.rank]||0)+1);
    const counts=Object.values(rc).sort((a,b)=>b-a);
    const isFlush = sorted.every(c=>c.suit===sorted[0].suit);
    const isStraight = sorted.every((c,i)=>i===0 || rIdx(c.rank)===rIdx(sorted[i-1].rank)+1);
    if(counts[0]===4){
      const quad=sorted.find(c=>rc[c.rank]===4);
      return {ok:true,kind:'ÈêµÊîØ',key:[rIdx(quad.rank),sIdx(quad.suit)]};
    }
    if(counts[0]===3&&counts[1]===2){
      const trip=sorted.find(c=>rc[c.rank]===3);
      return {ok:true,kind:'Ëë´ËòÜ',key:[rIdx(trip.rank),Math.max(...sorted.filter(c=>c.rank===trip.rank).map(c=>sIdx(c.suit)))]};
    }
    if(isFlush&&isStraight) return {ok:true,kind:'ÂêåËä±È†Ü',key:[rIdx(sorted[4].rank),sIdx(sorted[4].suit)]};
    if(isStraight) return {ok:true,kind:'È†ÜÂ≠ê',key:[rIdx(sorted[4].rank),sIdx(sorted[4].suit)]};
    if(isFlush) return {ok:true,kind:'ÂêåËä±',key:[rIdx(sorted[4].rank),sIdx(sorted[4].suit)]};
    return {ok:false};
  }
  return {ok:false};
}
function canBeat(a,b){
  const aa=analyze(a), bb=analyze(b);
  if(!aa.ok||!bb.ok) return false;
  if(aa.kind!==bb.kind){
    const bombs=['ÈêµÊîØ','ÂêåËä±È†Ü'];
    if(bombs.includes(aa.kind)&&!bombs.includes(bb.kind)) return true;
    if(!bombs.includes(aa.kind)&&bombs.includes(bb.kind)) return false;
    return false;
  }
  if(aa.key[0]!==bb.key[0]) return aa.key[0]>bb.key[0];
  return aa.key[1]>bb.key[1];
}

/* ÁµÑÂêàÁîüÊàê */
function combos(hand){
  const res=[];
  const n=hand.length;
  for(let i=0;i<n;i++) res.push([hand[i]]);
  for(let i=0;i<n;i++) for(let j=i+1;j<n;j++) res.push([hand[i],hand[j]]);
  for(let i=0;i<n;i++) for(let j=i+1;j<n;j++) for(let k=j+1;k<n;k++) res.push([hand[i],hand[j],hand[k]]);
  for(let i=0;i<n;i++) for(let j=i+1;j<n;j++) for(let k=j+1;k<n;k++) for(let l=k+1;l<n;l++) for(let m=l+1;m<n;m++) res.push([hand[i],hand[j],hand[k],hand[l],hand[m]]);
  return res.filter(c=>analyze(c).ok);
}

/* AI */
function pickLeaderCombo(all, enemyAlmostWin){
  const prefer = enemyAlmostWin ? ['ÂêåËä±È†Ü','ÈêµÊîØ','Ëë´ËòÜ','È†ÜÂ≠ê','‰∏âÊ¢ù','Â∞çÂ≠ê','ÂñÆÂºµ']
                                : ['È†ÜÂ≠ê','Ëë´ËòÜ','‰∏âÊ¢ù','Â∞çÂ≠ê','ÂñÆÂºµ'];
  for(const k of prefer){
    const cands = all.filter(c=>analyze(c).kind===k);
    if(cands.length) return cands[0];
  }
  return all[0]||null;
}
function pickResponseCombo(options, currentPlay){
  const needKind = analyze(currentPlay).kind;
  const same = options.filter(c=>analyze(c).kind===needKind);
  if(same.length) return same[0];
  const bombs = options.filter(c=>['ÈêµÊîØ','ÂêåËä±È†Ü'].includes(analyze(c).kind));
  if(bombs.length) return bombs[0];
  return options[0]||null;
}
function aiMove(i){
  const hand=players[i];
  const isLeader = !currentPlay || i===lastWinner;
  const all=combos(hand);
  const enemyAlmostWin = players.some((p,idx)=>idx!==i && p.length<=2);
  let options=[];
  if(!currentPlay){
    options = firstTrick ? all.filter(c=>c.some(x=>x.rank==='3'&&x.suit==='‚ô£')) : all;
    const choice = pickLeaderCombo(options, enemyAlmostWin);
    if(choice) play(i,choice); else { logAppendText(`${names[i]} PASS`); SFX.pass(); next(); }
    return;
  }else{
    options = all.filter(c=>canBeat(c,currentPlay));
    if(options.length){
      const choice = pickResponseCombo(options, currentPlay);
      play(i,choice); return;
    }
    if(isLeader){
      const nonSingles = all.filter(c=>analyze(c).kind!=='ÂñÆÂºµ');
      play(i, (nonSingles[0]||all[0]) );
    }else{
      logAppendText(`${names[i]} PASS`); SFX.pass(); next();
    }
  }
}

/* Âá∫ÁâåËàáÂõûÂêà */
function toStr(cards){ return cards.map(c=>c.suit+c.rank).join(' '); }
function renderPile(playerName,cards,kind){
  const pile=$('#pile'); pile.innerHTML='';
  const head=document.createElement('div'); head.style.fontSize='14px'; head.style.fontWeight='800'; head.style.marginBottom='8px'; head.textContent = `${playerName}Ôºà${kind}Ôºâ`;
  pile.appendChild(head);
  const row=document.createElement('div'); row.style.display='flex'; row.style.gap='10px'; row.style.flexWrap='wrap'; row.style.justifyContent='center';
  cards.forEach(c=>{ const d=document.createElement('div'); d.className='pile-card '+c.suit; d.textContent=c.suit+c.rank; row.appendChild(d); });
  pile.appendChild(row);
}
function play(i,cards){
  cards.forEach(sel=>{
    const idx=players[i].findIndex(p=>p.rank===sel.rank&&p.suit===sel.suit);
    if(idx>-1) players[i].splice(idx,1);
  });
  render();
  const an=analyze(cards);
  currentPlay=cards; lastWinner=i; firstTrick=false;
  setLast(`${names[i]}Ôºö${toStr(cards)}Ôºà${an.kind}Ôºâ`);
  logAppendPlay(names[i],cards,an.kind);
  renderPile(names[i],cards,an.kind);
  triggerFX(an.kind, cards);
  const includesSpade2 = cards.some(c=>c.rank==='2'&&c.suit==='‚ô†');
  SFX.playFor(an.kind, includesSpade2);

  if(players[i].length===0){ endRound(i); return; }
  next();
}
function next(){
  turn=(turn+1)%4;
  if(players[turn].length===0) turn=(turn+1)%4;
  if(turn===lastWinner){ currentPlay=null; setLast(`${names[turn]} ÈáçÊñ∞Âá∫Áâå`); $('#pile').innerHTML=''; clearFX(); }
  updateTurnUI();
  if(turn!==0 || (turn===0 && autoMy)) setTimeout(()=>aiMove(turn),600);
}
function selected(){ return [...document.querySelectorAll('#hand-bottom .card.selected')].map(el=>players[0][parseInt(el.dataset.idx,10)]); }
function onPlay(){
  if(turn!==0 || autoMy) return;
  const cs=selected();
  if(!cs.length){ info('Ë´ãÂÖàÈÅ∏Áâå'); return; }
  const an=analyze(cs);
  if(!an.ok){ info('‰∏çÂêàÊ≥ïÁµÑÂêà'); return; }
  if(firstTrick && !cs.some(c=>c.rank==='3'&&c.suit==='‚ô£')){ info('È¶ñÊîªÂøÖÂê´ ‚ô£3'); return; }
  if(currentPlay && !canBeat(cs,currentPlay)){ info('ÊØî‰∏çÈÅéÂâçÂÆ∂'); return; }
  play(0,cs);
}
function onPass(){
  if(turn!==0 || autoMy) return;
  if(!currentPlay){ info('È¶ñÊîª‰∏çÂèØ PASS'); return; }
  info('‰Ω† PASS'); logAppendText('‰Ω† PASS'); SFX.pass(); next();
}

/* Ë®àÂàÜËàáÁµêÁÆó */
function hasFourOfKind(hand){ const rc={}; hand.forEach(c=>rc[c.rank]=(rc[c.rank]||0)+1); return Object.values(rc).some(v=>v===4); }
function hasStraightFlush(hand){
  const bySuit={'‚ô£':[], '‚ô¶':[], '‚ô•':[], '‚ô†':[]};
  hand.forEach(c=>bySuit[c.suit].push(c));
  for(const s in bySuit){
    const arr=bySuit[s].sort(compareCard);
    for(let i=0;i<=arr.length-5;i++){
      const slice=arr.slice(i,i+5);
      if(slice.length===5 && slice.every((c,idx)=>idx===0 || rIdx(c.rank)===rIdx(slice[idx-1].rank)+1)) return true;
    }
  }
  return false;
}
function endRound(winnerIdx){
  const per=[]; let totalGain=0;
  for(let i=0;i<4;i++){
    if(i===winnerIdx) continue;
    const remain=players[i];
    let base = remain.length*10;
    let factor = 1;
    const why=[];
    why.push(`Ââ© ${remain.length} Âºµ √ó10 = ${base}`);
    if(remain.length>=8){ factor*=2; why.push('‚â•8 Âºµ √ó2'); }
    if(remain.some(c=>c.rank==='2')){ factor*=2; why.push('Âê´ 2 √ó2'); }
    if(hasFourOfKind(remain)){ factor*=2; why.push('ÈêµÊîØ √ó2'); }
    if(hasStraightFlush(remain)){ factor*=2; why.push('ÂêåËä±È†Ü √ó2'); }
    const pen = base*factor;
    scores[i]-=pen; totalGain+=pen;
    per.push({i,name:names[i],delta:-pen,explain:why.join('„ÄÅ'),after:scores[i]});
  }
  scores[winnerIdx]+=totalGain;
  per.push({i:winnerIdx,name:names[winnerIdx],delta:+totalGain,explain:`Ë¥èËµ∞ÂÖ∂‰ªñÁé©ÂÆ∂Êá≤ÁΩ∞Á∏ΩÂíå +${totalGain}`,after:scores[winnerIdx]});
  updateScoreUI(); saveScores();

  showRound(per, winnerIdx);
  const zeroIdx = scores.findIndex(s=>s<=0);
  if(zeroIdx!==-1){ showSeries(); }
}

function showRound(per, winnerIdx){
  const list = $('#roundList'); list.innerHTML='';
  $('#roundTitle').innerText = `Êú¨Â±ÄÁµêÁÆóÔºö${names[winnerIdx]} ËÑ´Êâã`;
  per.sort((a,b)=>a.i-b.i).forEach(row=>{
    const li=document.createElement('li'); li.className='pItem';
    const left=document.createElement('div');
    left.innerHTML = `<div class="pName">${row.name}</div><div class="pExplain">${row.explain}</div>`;
    const right=document.createElement('div'); right.className='pRight';
    const delta=document.createElement('div'); delta.className='pDelta '+(row.delta>=0?'plus':'minus'); delta.textContent = (row.delta>=0?'+':'')+row.delta;
    const after=document.createElement('div'); after.className='pScore'; after.textContent = row.after+' ÂàÜ';
    right.appendChild(delta); right.appendChild(after);
    li.appendChild(left); li.appendChild(right); list.appendChild(li);
  });
  document.getElementById('roundOverlay').style.display='flex';
  pendingDeal=true;
}
function showSeries(){
  const rank = scores.map((s,i)=>({i, name:names[i], score:s})).sort((a,b)=>b.score-a.score);
  const ul = $('#rankList'); ul.innerHTML='';
  rank.forEach((r,idx)=>{
    const li=document.createElement('li'); li.innerHTML = `<div>${idx+1}. ${r.name}</div><div>${r.score} ÂàÜ</div>`; ul.appendChild(li);
  });
  document.getElementById('seriesOverlay').style.display='flex';
}

document.getElementById('roundContinueBtn').onclick=()=>{
  document.getElementById('roundOverlay').style.display='none';
  if(pendingDeal){ pendingDeal=false; deal(); }
};
document.getElementById('restartSeriesBtn').onclick=()=>{
  scores=[10000,10000,10000,10000]; saveScores(); updateScoreUI();
  document.getElementById('seriesOverlay').style.display='none';
};
document.getElementById('closeSeriesBtn').onclick=()=>{ document.getElementById('seriesOverlay').style.display='none'; };

/* ====== ÊèêÁ§∫ ====== */
const HINT_TYPES=['ÂñÆÂºµ','Â∞çÂ≠ê','‰∏âÊ¢ù','È†ÜÂ≠ê','Ëë´ËòÜ','ÈêµÊîØ','ÂêåËä±È†Ü'];
const hintOverlay=$('#hintOverlay'), hintToolbar=$('#hintToolbar'), hintSections=$('#hintSections');
let hintOnlyBeat=true, hintNeedType=null;
function openHints(){
  hintNeedType = currentPlay ? analyze(currentPlay).kind : null;
  hintOnlyBeat = !!currentPlay;
  renderHint();
  hintOverlay.style.display='flex';
}
function closeHints(){ hintOverlay.style.display='none'; }
hintOverlay.addEventListener('click', e=>{ if(e.target===hintOverlay) closeHints(); });

function makeChip(text, active, onClick){
  const c=document.createElement('div'); c.className='chip'+(active?' active':''); c.textContent=text; c.onclick=onClick; return c;
}
function renderHint(){
  hintToolbar.innerHTML=''; hintSections.innerHTML='';
  hintToolbar.appendChild(makeChip(hintOnlyBeat?'Âè™ÁúãÂèØÂ£ìÈÅéÔºàÈñãÔºâ':'Âè™ÁúãÂèØÂ£ìÈÅéÔºàÈóúÔºâ', hintOnlyBeat, ()=>{ hintOnlyBeat=!hintOnlyBeat; renderHint(); }));
  HINT_TYPES.forEach(t=>{
    hintToolbar.appendChild(makeChip(t+(hintNeedType===t?' ‚úì':''), hintNeedType===t, ()=>{ hintNeedType = (hintNeedType===t? null : t); renderHint(); }));
  });
  let arr = combos(players[0]);
  if(firstTrick) arr = arr.filter(c=>c.some(x=>x.rank==='3'&&x.suit==='‚ô£'));
  if(hintOnlyBeat && currentPlay) arr = arr.filter(c=>canBeat(c,currentPlay));
  if(hintNeedType) arr = arr.filter(c=>analyze(c).kind===hintNeedType);
  if(arr.length===0){ hintSections.textContent='ÔºàÁõÆÂâçÊ≤íÊúâÂèØÂá∫ÁöÑÁµÑÂêàÔºâ'; return; }
  const groups={}; arr.forEach(c=>{ const k=analyze(c).kind; (groups[k]=groups[k]||[]).push(c); });
  HINT_TYPES.forEach(k=>{
    if(!groups[k]||groups[k].length===0) return;
    const sec=document.createElement('div'); sec.className='section';
    const h4=document.createElement('h4'); h4.textContent=`${k}Ôºà${groups[k].length}Ôºâ`; sec.appendChild(h4);
    const grid=document.createElement('div'); grid.className='combo-grid';
    groups[k].forEach(c=>{
      const row=document.createElement('div'); row.className='combo-row';
      c.forEach(card=>{ const m=document.createElement('div'); m.className='mini '+card.suit; m.textContent=card.suit+card.rank; row.appendChild(m); });
      const tag=document.createElement('div'); tag.className='tag'; tag.textContent=k; row.appendChild(tag);
      row.onclick=()=>{
        document.querySelectorAll('#hand-bottom .card').forEach(el=>el.classList.remove('selected'));
        const hb=[...document.querySelectorAll('#hand-bottom .card')];
        const need=c.map(x=>x.suit+x.rank);
        hb.forEach(el=>{ const key=el.textContent; const idx=need.indexOf(key); if(idx>-1){ el.classList.add('selected'); need.splice(idx,1); } });
        closeHints();
      };
      grid.appendChild(row);
    });
    sec.appendChild(grid);
    hintSections.appendChild(sec);
  });
}

/* Á∂ÅÂÆö */
document.getElementById('playBtn').onclick=onPlay;
document.getElementById('passBtn').onclick=onPass;
document.getElementById('dealBtn').onclick=deal;
document.getElementById('hintBtn').onclick=openHints;
document.getElementById('resetScoreBtn').onclick=()=>{ scores=[10000,10000,10000,10000]; saveScores(); updateScoreUI(); logAppendText('üîÑ ÂàÜÊï∏Â∑≤ÈáçÁΩÆÁÇ∫ 10000'); };
document.getElementById('autoBtn').onclick=()=>{
  autoMy = !autoMy;
  document.getElementById('autoBtn').textContent = `‰ª£ÊâìÔºö${autoMy?'Èñã':'Èóú'}`;
  try{ localStorage.setItem('big2_auto', autoMy?'1':'0'); }catch(e){}
  updateTurnUI();
  if(autoMy && turn===0){ setTimeout(()=>aiMove(0), 450); }
};

/* ÈñãÂ±Ä */
function deal(){
  names=['‰Ω†',randName(),randName(),randName()];
  document.getElementById('name-right').innerText=names[1]; document.getElementById('name-top').innerText=names[2]; document.getElementById('name-left').innerText=names[3];
  document.getElementById('pile').innerHTML=''; logBox.innerHTML=''; setLast(''); clearFX();
  buildDeck(); shuffle(deck);
  players=[[],[],[],[]];
  for(let i=0;i<52;i++) players[i%4].push(deck[i]);
  players.forEach(p=>p.sort(compareCard));
  currentPlay=null; lastWinner=-1; firstTrick=true; turn=findStart();
  render(); updateTurnUI(); info(`ÊåÅÊúâ ‚ô£3 ÁöÑÁé©ÂÆ∂Ôºà${names[turn]}ÔºâÂÖàÊîª`);
  if(turn!==0) setTimeout(()=>aiMove(turn),600);
}

(function boot(){
  loadScores();
  try{
    const savedAuto = localStorage.getItem('big2_auto');
    if(savedAuto==='1'){ autoMy=true; document.getElementById('autoBtn').textContent='‰ª£ÊâìÔºöÈñã'; }
    const bgmBtn = document.getElementById('bgmToggle');
    const savedBgm = localStorage.getItem('big2_bgm');
    if(savedBgm==='1'){ bgmBtn.textContent='Èü≥Ê®ÇÔºöÈñã'; }
  }catch(e){}
  deal();
})();
</script>
</body>
</html>

